Vagrant.configure("2") do |lin_config|
  # Use a Ubuntu 24.04 box that supports VMware
  lin_config.vm.box = "gusztavvargadr/ubuntu-desktop" 
  lin_config.vm.box_version = ">= 0"

  lin_config.vm.communicator = "ssh"

  # Provider: VMware Workstation Pro
  lin_config.vm.provider "vmware_desktop" do |v|
    v.gui = true
    v.memory = 8192
    v.cpus = 4

    v.vmx["displayName"] = "DFIR Investigation VM - Ubuntu"
    v.force_vmware_license = "workstation"
  end

  # Check the host system
  host_os = RbConfig::CONFIG['host_os']

  if host_os =~ /linux/
    lin_config.vm.provision "ansible" do |ansible|
      ansible.playbook = "ansible/playbook.yml"
    end
  elsif host_os =~ /mswin|mingw|cygwin/
    lin_config.vm.provision "shell", path: "scripts/install_sift.sh"
  end
end